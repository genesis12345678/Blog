<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title>블로그 글 목록</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">

    <style>
        .visually-hidden {
            position: absolute;
            width: 1px;
            height: 1px;
            margin: -1px;
            padding: 0;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            border: 0;
        }
    </style>
</head>
<body>

<div th:replace="~{fragments/header :: common_header}"></div>

<div class="container">
    <table class="table table-bordered">
        <thead>
            <tr>
                <th class="visually-hidden">번호</th>
                <th>제목</th>
                <th>작성일</th>
                <th>작성자</th>
            </tr>
        </thead>
        <tbody id="article-list">
            <tr th:each="article, iter : ${articles}">
                <td th:text="${iter.count}"></td>
                <td>
                    <a th:href="@{/articles/{id}(id=${article.id})}" th:text="${article.title}"></a>
                </td>
                <td>
                    <span th:if="${#temporals.format(article.createdAt.toLocalDate(), 'yyyy-MM-dd').equals(#temporals.format(currentDate, 'yyyy-MM-dd'))}"
                              th:text="${#temporals.format(article.createdAt, 'HH:mm')}"></span>
                    <span th:unless="${#temporals.format(article.createdAt.toLocalDate(), 'yyyy-MM-dd').equals(#temporals.format(currentDate, 'yyyy-MM-dd'))}"
                          th:text="${#temporals.format(article.createdAt, 'yyyy-MM-dd')}"></span>
                </td>
                <td>
                    <a th:text="${article.author}"></a>
                </td>
            </tr>
        </tbody>
    </table>

    <div class="mb-3 d-flex justify-content-between align-items-center">
        <div>
            <select id="search-type" class="form-select">
                <option th:each="type : ${searchType}"
                        th:value="${type.description_en}"
                        th:text="${type.description_kr}"></option>
            </select>
            <label for="search-type" class="form-label">(으)로 조회</label>
        </div>

        <a type="button" sec:authorize="isAuthenticated()"
           href="/new-article" class="btn btn-secondary btn-sm mb-3">
            글 등록
        </a>
    </div>

    <div id="search-title" class="mb-3" style="display: none;">
        <label for="searchTitle" class="form-label">제목</label>
        <input type="text" id="searchTitle" class="form-control">
    </div>

    <div id="search-content" class="mb-3" style="display: none;">
        <label for="searchContent" class="form-label">내용</label>
        <input type="text" id="searchContent" class="form-control">
    </div>

    <div id="search-author" class="mb-3" style="display: none;">
        <label for="searchAuthor" class="form-label">작성자</label>
        <input type="text" id="searchAuthor" class="form-control">
    </div>

    <div id="search-title-content" class="mb-3" style="display: none;">
        <label for="searchTitleWithContent" class="form-label">제목</label>
        <input type="text" id="searchTitleWithContent" class="form-control">
        <label for="searchContentWithTitle" class="form-label mt-2">내용</label>
        <input type="text" id="searchContentWithTitle" class="form-control">
    </div>

    <div id="search-date" class="mb-3" style="display: none;">
        <label for="search-date-start" class="form-label">시작</label>
        <input type="date" id="search-date-start" class="form-control">
        <label for="search-date-end" class="form-label mt-2">종료</label>
        <input type="date" id="search-date-end" class="form-control">
    </div>

    <button style="margin-bottom: 50px" onclick="submitForm()" class="btn btn-primary mt-3">검색</button>
</div>

<script src="/js/search.js"></script>
<script src="/js/renderData.js"></script>
<script src="/js/searchPageEvents.js"></script>
</body>
</html>